<%- include("../partials/header", {title}) %>
<main class="main-container">
  <div class="addTask">
<h1>Add Tasks</h1>

<% if (user) { %>
<form action="/tasks" method="POST" class="new-form">
  <label>Name:
      <input type="text" name="taskName">
  </label>
  <label>Due Date:
      <input type="date" name="dueDate">
  </label>
  <label>Task Type:
      <select name="taskType">
          <option value="Work">Work</option>
          <option value="Health">Health</option>
          <option value="Fitness">Fitness</option>
          <option value="Household">Household</option>
          <option value="Travel">Travel</option>
          <option value="Shopping">Shopping</option>
          <option value="Other">Other</option>
      </select>
  </label>
  <div class="button-wrapper">
  <button class="addBtn" type="submit">Add Task</button>
  </div>
</div>

</form>
<section class="results">
  <% tasks.forEach(t => { %>
    <article class="task">
      <h3 class="task-title"><%=t.taskName%></h3>
      <p class="task-info">Due Date: <%=t.dueDate%></p>
      <p class="task-info">Task Type: <%=t.taskType%></p>
      <form action="/tasks/<%= t._id %>?_method=DELETE"
        class="delete-form" method="POST">
        <button type="submit">Delete</button>
      </form>
    </article>
<%}else { %>
  <h2>Please <a href="/auth/google">Login</a> to Add a Task</h2>
<%} %>
<section class="results"><% tasks.forEach(t => { %>
  <div>Name:</div>
  <div>
      <%=t.taskName%>
  </div>
  <div>Due Date:</div>
  <div>
    <%=t.dueDate%> 
  </div>
  <div>Task Type:</div>
  <div>
      <%=t.taskType%>
  </div>

  <% if (user?._id.equals(t.user)) { %>

  <form action="/tasks/<%= t._id %>?_method=DELETE"
    class="delete-form" method="POST">
    <button type="submit">Delete</button>
  </form>
  <% } %>
  <br>
  <% }) %>
</section>
</main>

<%- include("../partials/footer") %>